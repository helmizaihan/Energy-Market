<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Market Discussion Notes</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { 
            --energy-navy: #002347; 
            --electric-teal: #00a8a8; 
            --text-dark: #1e293b;
        }
        
        body { 
            background-color: #f1f5f9; 
            color: var(--text-dark); 
            font-family: 'Inter', sans-serif; 
            padding: 40px 0; 
        }

        .document-sheet {
            background: #fff;
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            padding: 60px 80px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            border-top: 15px solid var(--energy-navy);
        }

        /* Prominent Header Styling */
        .brand-header { text-align: center; margin-bottom: 50px; }
        .energy-title { 
            font-weight: 900; 
            font-size: 3rem; 
            color: var(--energy-navy); 
            letter-spacing: -1px;
            margin-bottom: 0;
            line-height: 1;
        }
        .notes-subtitle { 
            font-weight: 400; 
            font-size: 1.2rem; 
            color: var(--electric-teal); 
            text-transform: uppercase; 
            letter-spacing: 4px;
        }

        /* Metadata & Date Section */
        .meta-row { border-bottom: 1px solid #eee; padding-bottom: 20px; margin-bottom: 30px; }
        .meta-label { font-size: 0.7rem; font-weight: 700; color: #94a3b8; text-transform: uppercase; margin-bottom: 5px; }
        
        input, textarea {
            border: none !important;
            background: transparent !important;
            width: 100%;
            outline: none;
            color: inherit;
            padding: 0;
            display: block;
        }

        /* Auto-adjusting Text Boxes */
        .adjustable-box {
            min-height: 40px;
            line-height: 1.6;
            margin-bottom: 10px;
            transition: height 0.2s;
        }

        /* Attendee List Styling */
        .attendee-pill {
            display: inline-block;
            background: #f1f5f9;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 0.85rem;
            margin: 0 5px 5px 0;
            border: 1px solid #e2e8f0;
        }

        /* Tables */
        .table { margin-top: 10px; border: none; }
        .table thead th { 
            background-color: var(--energy-navy); 
            color: #fff; 
            font-size: 0.75rem; 
            text-transform: uppercase; 
            padding: 12px;
            border: none;
        }
        .table td { border-bottom: 1px solid #f1f5f9; padding: 15px 12px; vertical-align: top; }

        /* Buttons & Toolbar */
        .toolbar { position: fixed; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 1000; }
        .btn-main { background: #fff; border: 1px solid var(--energy-navy); color: var(--energy-navy); font-weight: 700; padding: 10px 20px; border-radius: 8px; font-size: 0.8rem; }
        .btn-main:hover { background: var(--energy-navy); color: #fff; }
        .btn-add-item { background: transparent; border: 1px dashed var(--electric-teal); color: var(--electric-teal); font-size: 0.75rem; font-weight: 600; padding: 5px 15px; border-radius: 4px; margin-top: 10px; }

        @media print {
            body { background: #fff; padding: 0; }
            .document-sheet { box-shadow: none; border-top: 15px solid var(--energy-navy); width: 100%; padding: 20px; }
            .no-print { display: none !important; }
            .attendee-pill { border: none; padding: 0; background: transparent; }
            .attendee-pill::after { content: ", "; }
            .attendee-pill:last-child::after { content: ""; }
        }
    </style>
</head>
<body>

<div class="toolbar no-print">
    <button class="btn-main" onclick="window.print()">Download PDF</button>
    <button class="btn-main" onclick="exportWord()">Export to Word</button>
</div>

<div class="document-sheet" id="reportContent">
    <div class="brand-header">
        <h1 class="energy-title">ENERGY MARKET</h1>
        <p class="notes-subtitle">Discussion Notes</p>
    </div>

    <div class="row meta-row">
        <div class="col-8 border-end">
            <div class="meta-label">Discussion Subject</div>
            <input type="text" class="fw-bold fs-4" style="color: var(--energy-navy);" placeholder="e.g. Natural Gas Pricing Structure 2026">
        </div>
        <div class="col-4 ps-4">
            <div class="meta-label">Date (MY)</div>
            <input type="text" id="currentDate" class="fw-bold" placeholder="DD/MM/YYYY">
        </div>
    </div>

    <div class="mb-5">
        <div class="meta-label">List of Attendees</div>
        <div id="attendeeContainer" class="mb-2">
            </div>
        <div class="input-group no-print" style="max-width: 300px;">
            <input type="text" id="attendeeInput" class="form-control form-control-sm border" style="background: #fff !important; padding: 5px 10px !important;" placeholder="Enter name...">
            <button class="btn btn-sm btn-dark" onclick="addAttendee()">Add Participant</button>
        </div>
    </div>

    <div class="mb-5">
        <h5 class="fw-bold" style="color: var(--energy-navy); border-left: 4px solid var(--electric-teal); padding-left: 15px;">Summary of Deliberations</h5>
        <table class="table" id="discTable">
            <thead>
                <tr>
                    <th style="width: 40px">#</th>
                    <th>Discussion Points & Paragraphs</th>
                    <th style="width: 40px" class="no-print"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="text-muted small fw-bold">01</td>
                    <td>
                        <textarea class="adjustable-box" rows="1" placeholder="Start typing discussion details..." oninput="autoGrow(this)"></textarea>
                    </td>
                    <td class="no-print text-end">
                        <button class="btn btn-sm text-danger" onclick="this.closest('tr').remove()">×</button>
                    </td>
                </tr>
            </tbody>
        </table>
        <button class="btn-add-item no-print" onclick="addDiscRow()">+ Add New Discussion Block</button>
    </div>

    <div class="mb-5">
        <h5 class="fw-bold" style="color: var(--energy-navy); border-left: 4px solid var(--electric-teal); padding-left: 15px;">Required Actions</h5>
        <table class="table" id="actTable">
            <thead>
                <tr>
                    <th>Task Description</th>
                    <th style="width: 180px">Owner</th>
                    <th style="width: 140px">Deadline</th>
                    <th style="width: 40px" class="no-print"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><textarea class="adjustable-box" rows="1" placeholder="Describe task..." oninput="autoGrow(this)"></textarea></td>
                    <td><input type="text" placeholder="Name"></td>
                    <td><input type="text" placeholder="DD/MM/YYYY"></td>
                    <td class="no-print text-end"><button class="btn btn-sm text-danger" onclick="this.closest('tr').remove()">×</button></td>
                </tr>
            </tbody>
        </table>
        <button class="btn-add-item no-print" onclick="addActionRow()">+ Add New Action Item</button>
    </div>

    <div class="mt-5 pt-4 border-top">
        <div class="meta-label">Prepared By</div>
        <input type="text" class="fw-bold border-bottom" style="max-width: 300px; border-bottom: 2px solid var(--energy-navy) !important;" placeholder="Reporter Name / Designation">
        <p class="text-muted mt-2" style="font-size: 0.6rem;">Energy Market Division | Internal Document</p>
    </div>
</div>

<script>
    // Initialize MY Date
    window.onload = function() {
        const today = new Date();
        const dd = String(today.getDate()).padStart(2, '0');
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const yyyy = today.getFullYear();
        document.getElementById('currentDate').value = dd + '/' + mm + '/' + yyyy;
    }

    // Auto-expand Textareas
    function autoGrow(element) {
        element.style.height = "5px";
        element.style.height = (element.scrollHeight) + "px";
    }

    // Manage Attendees
    function addAttendee() {
        const input = document.getElementById('attendeeInput');
        const name = input.value.trim();
        if (name) {
            const container = document.getElementById('attendeeContainer');
            const pill = document.createElement('span');
            pill.className = 'attendee-pill';
            pill.innerHTML = `${name} <span class="no-print" style="cursor:pointer; margin-left:5px; color:red;" onclick="this.parentElement.remove()">×</span>`;
            container.appendChild(pill);
            input.value = '';
            input.focus();
        }
    }

    // Add Dynamic Rows
    function addDiscRow() {
        const table = document.getElementById('discTable').getElementsByTagName('tbody')[0];
        const row = table.insertRow();
        const num = String(table.rows.length).padStart(2, '0');
        row.innerHTML = `<td class="text-muted small fw-bold">${num}</td>
                         <td><textarea class="adjustable-box" rows="1" oninput="autoGrow(this)"></textarea></td>
                         <td class="no-print text-end"><button class="btn btn-sm text-danger" onclick="this.closest('tr').remove()">×</button></td>`;
    }

    function addActionRow() {
        const table = document.getElementById('actTable').getElementsByTagName('tbody')[0];
        const row = table.insertRow();
        row.innerHTML = `<td><textarea class="adjustable-box" rows="1" oninput="autoGrow(this)"></textarea></td>
                         <td><input type="text"></td>
                         <td><input type="text" placeholder="DD/MM/YYYY"></td>
                         <td class="no-print text-end"><button class="btn btn-sm text-danger" onclick="this.closest('tr').remove()">×</button></td>`;
    }

    function exportWord() {
        const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'></head><body>";
        const footer = "</body></html>";
        const html = header + document.getElementById('reportContent').innerHTML + footer;
        const blob = new Blob(['\ufeff', html], { type: 'application/msword' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'Energy_Market_Notes.doc';
        link.click();
    }
</script>

</body>
</html>
