<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Market Minutes</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Lora:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --text-main: #1a1a1a; --text-sub: #4a4a4a; --accent: #004a99; }
        body { background-color: #fcfcfc; color: var(--text-main); font-family: 'Inter', sans-serif; padding: 40px 0; }
        
        .document-paper { 
            background: white; 
            max-width: 900px; 
            margin: 0 auto; 
            padding: 60px 80px; 
            box-shadow: 0 0 20px rgba(0,0,0,0.03); 
            border-radius: 2px;
        }
        
        .dept-header { font-weight: 800; color: var(--accent); letter-spacing: 0.05em; margin-bottom: 5px; font-size: 1.1rem; text-transform: uppercase; }
        .doc-title { font-family: 'Lora', serif; font-size: 2.2rem; font-weight: 700; margin-bottom: 40px; border-bottom: 2px solid #eee; padding-bottom: 20px; }
        
        /* Clean Document Inputs */
        input, textarea { 
            border: none !important; 
            background: transparent !important; 
            padding: 0 !important; 
            width: 100%;
            outline: none;
            color: var(--text-main);
        }
        textarea { font-family: inherit; resize: none; overflow: hidden; }
        
        .meta-label { font-weight: 600; font-size: 0.75rem; color: #999; text-transform: uppercase; margin-bottom: 4px; letter-spacing: 0.5px; }
        .meta-value { border-bottom: 1px solid #f0f0f0 !important; padding-bottom: 5px !important; margin-bottom: 25px !important; transition: 0.3s; }
        .meta-value:focus { border-bottom-color: var(--accent) !important; }
        
        /* Tables */
        .table { margin-top: 15px; border-color: #f0f0f0; }
        .table th { border-top: none; font-size: 0.8rem; color: #999; text-transform: uppercase; letter-spacing: 1px; padding: 12px 10px; font-weight: 600; }
        .table td { padding: 12px 10px; vertical-align: top; }
        
        /* Prepared By Section */
        .prepared-section { margin-top: 80px; border-top: 1px solid #eee; pt-4; }
        .signature-line { border-bottom: 1px solid #1a1a1a !important; max-width: 300px; margin-bottom: 10px !important; }

        /* Control UI */
        .controls { max-width: 900px; margin: 0 auto 30px auto; display: flex; gap: 10px; justify-content: center; }
        .btn-doc { padding: 8px 18px; font-size: 0.85rem; font-weight: 600; border-radius: 4px; transition: 0.2s; }
        .btn-add { background: #f8fafc; color: var(--accent); margin-top: 5px; font-size: 0.75rem; border: 1px dashed #cbd5e1; }
        .btn-add:hover { background: #f1f5f9; }

        @media print {
            body { background: white; padding: 0; }
            .document-paper { padding: 0; box-shadow: none; width: 100%; max-width: 100%; }
            .no-print { display: none !important; }
            .meta-value { border-bottom: none !important; }
            .signature-line { border-bottom: 1px solid #000 !important; }
            .table th { background-color: #fafafa !important; -webkit-print-color-adjust: exact; }
        }
    </style>
</head>
<body>

<div class="controls no-print">
    <button class="btn btn-dark btn-doc" onclick="window.print()">Save PDF / Print</button>
    <button class="btn btn-primary btn-doc" onclick="exportWord()">Export to Word</button>
    <button class="btn btn-outline-secondary btn-doc" onclick="shareWhatsApp()">Share via WhatsApp</button>
</div>

<div class="document-paper" id="contentToExport">
    <div class="dept-header">Energy Market</div>
    <h1 class="doc-title">Minutes of Meeting</h1>

    <div class="row">
        <div class="col-8">
            <div class="meta-label">Subject</div>
            <input type="text" class="meta-value" placeholder="Title of the discussion...">
        </div>
        <div class="col-4">
            <div class="meta-label">Date</div>
            <input type="date" id="mDate" class="meta-value">
        </div>
        <div class="col-12 mt-2">
            <div class="meta-label">Attendees</div>
            <textarea rows="1" class="meta-value" placeholder="Names of participants..." oninput="autoGrow(this)"></textarea>
        </div>
    </div>

    <div class="mt-4">
        <h5 class="fw-bold mb-3">Discussion Summary</h5>
        <table class="table" id="discussionTable">
            <thead>
                <tr>
                    <th style="width: 5%">#</th>
                    <th>Deliberations & Decisions</th>
                    <th style="width: 5%" class="no-print"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><textarea rows="1" placeholder="Record key point..." oninput="autoGrow(this)"></textarea></td>
                    <td class="no-print text-end"><button class="btn btn-sm text-danger p-0" onclick="this.closest('tr').remove()">×</button></td>
                </tr>
            </tbody>
        </table>
        <button class="btn btn-sm btn-add no-print" onclick="addRow('discussionTable')">+ Add Discussion Point</button>
    </div>

    <div class="mt-5">
        <h5 class="fw-bold mb-3">Action Items</h5>
        <table class="table" id="actionTable">
            <thead>
                <tr>
                    <th>Required Task</th>
                    <th style="width: 25%">Owner</th>
                    <th style="width: 20%">Deadline</th>
                    <th style="width: 5%" class="no-print"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" placeholder="Task description..."></td>
                    <td><input type="text" placeholder="Name"></td>
                    <td><input type="date"></td>
                    <td class="no-print text-end"><button class="btn btn-sm text-danger p-0" onclick="this.closest('tr').remove()">×</button></td>
                </tr>
            </tbody>
        </table>
        <button class="btn btn-sm btn-add no-print" onclick="addActionRow()">+ Add Action Task</button>
    </div>

    <div class="prepared-section mt-5 pt-4">
        <div class="row">
            <div class="col-6">
                <div class="meta-label">Prepared By</div>
                <input type="text" class="meta-value signature-line" placeholder="Name & Designation">
                <div class="meta-label mt-2">Date of Report</div>
                <input type="date" id="prepDate" class="meta-value">
            </div>
        </div>
    </div>
</div>

<script>
    // Set default dates to today
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('mDate').value = today;
    document.getElementById('prepDate').value = today;

    function autoGrow(element) {
        element.style.height = "5px";
        element.style.height = (element.scrollHeight) + "px";
    }

    function addRow(id) {
        const table = document.getElementById(id).getElementsByTagName('tbody')[0];
        const count = table.rows.length + 1;
        const row = table.insertRow();
        row.innerHTML = `<td>${count}</td>
                         <td><textarea rows="1" oninput="autoGrow(this)"></textarea></td>
                         <td class="no-print text-end"><button class="btn btn-sm text-danger p-0" onclick="this.closest('tr').remove()">×</button></td>`;
    }

    function addActionRow() {
        const table = document.getElementById('actionTable').getElementsByTagName('tbody')[0];
        const row = table.insertRow();
        row.innerHTML = `<td><input type="text"></td>
                         <td><input type="text"></td>
                         <td><input type="date"></td>
                         <td class="no-print text-end"><button class="btn btn-sm text-danger p-0" onclick="this.closest('tr').remove()">×</button></td>`;
    }

    function exportWord() {
        const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'></head><body>";
        const footer = "</body></html>";
        const content = document.getElementById('contentToExport').innerHTML;
        const blob = new Blob(['\ufeff', header + content + footer], { type: 'application/msword' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'Energy_Market_Minutes.doc';
        link.click();
    }

    function shareWhatsApp() {
        const subject = document.querySelector('input[placeholder="Title of the discussion..."]').value || "Meeting";
        const msg = `*Energy Market Minutes*\n*Subject:* ${subject}\n*Date:* ${document.getElementById('mDate').value}\n\nThe document is ready for review.`;
        window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, '_blank');
    }
</script>

</body>
</html>
