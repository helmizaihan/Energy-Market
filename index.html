<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Market Minutes</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Modern Corporate Palette */
        :root { --navy: #002B5B; --slate: #475569; --border: #e2e8f0; }

        body { 
            background-color: #f1f5f9; 
            color: #1e293b; 
            font-family: 'Inter', sans-serif; 
            padding: 50px 0; 
        }

        /* Document Sheet */
        .page {
            background: white;
            width: 210mm; /* A4 Width */
            min-height: 297mm;
            margin: 0 auto;
            padding: 80px 90px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            position: relative;
        }

        /* Clean Typography */
        .brand-header { 
            font-weight: 700; 
            color: var(--navy); 
            text-transform: uppercase; 
            letter-spacing: 2px; 
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .doc-title { 
            font-family: 'Playfair Display', serif; 
            font-size: 2.8rem; 
            margin-bottom: 50px; 
            border-bottom: 1px solid var(--border);
            padding-bottom: 20px;
        }

        /* Invisible Inputs (Look like text) */
        input, textarea {
            border: none !important;
            background: transparent !important;
            padding: 0 !important;
            width: 100%;
            outline: none;
            color: inherit;
            font-family: inherit;
            display: block;
        }
        
        input::placeholder, textarea::placeholder { color: #cbd5e1; }
        textarea { resize: none; overflow: hidden; }

        /* Document Structure */
        .meta-group { margin-bottom: 30px; }
        .label { 
            font-size: 0.7rem; 
            font-weight: 700; 
            text-transform: uppercase; 
            color: var(--slate); 
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        
        .value-text { 
            font-size: 1rem; 
            padding-bottom: 8px; 
            border-bottom: 1px solid #f1f5f9 !important; 
        }

        /* Elegant Tables */
        .table { margin-top: 30px; border: none; }
        .table thead th {
            background-color: #f8fafc;
            border-bottom: 2px solid var(--navy);
            color: var(--navy);
            font-size: 0.75rem;
            text-transform: uppercase;
            padding: 12px;
        }
        .table td { border-bottom: 1px solid var(--border); padding: 15px 12px; vertical-align: top; }

        /* Prepared By Section */
        .footer-sign { margin-top: 100px; border-top: 1px solid var(--border); padding-top: 30px; }
        .sig-line { 
            border-bottom: 1px solid #000 !important; 
            max-width: 250px; 
            margin-bottom: 10px;
            font-weight: 600;
        }

        /* Interface Controls */
        .toolbar { 
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%); 
            z-index: 1000; display: flex; gap: 10px; 
        }
        .btn-tool { 
            background: white; border: 1px solid var(--border); padding: 8px 20px; 
            border-radius: 50px; font-weight: 600; font-size: 0.85rem; transition: 0.3s;
        }
        .btn-tool:hover { background: var(--navy); color: white; border-color: var(--navy); }
        .btn-add { font-size: 0.75rem; color: var(--navy); background: #f8fafc; border: none; margin-top: 10px; }

        /* Print/Export Logic */
        @media print {
            body { background: white; padding: 0; }
            .page { box-shadow: none; margin: 0; padding: 40px; width: 100%; }
            .toolbar, .no-print { display: none !important; }
            .value-text { border-bottom: none !important; }
            input::placeholder, textarea::placeholder { color: transparent; }
        }
    </style>
</head>
<body>

<div class="toolbar no-print">
    <button class="btn-tool" onclick="window.print()">Download PDF</button>
    <button class="btn-tool" onclick="exportWord()">Export to Word</button>
    <button class="btn-tool" onclick="shareWhatsApp()">WhatsApp Summary</button>
</div>

<div class="page" id="documentArea">
    <div class="brand-header">Energy Market</div>
    <h1 class="doc-title">Minutes of Meeting</h1>

    <div class="row">
        <div class="col-8">
            <div class="meta-group">
                <div class="label">Discussion Subject</div>
                <input type="text" class="value-text fw-bold" style="font-size: 1.2rem;" placeholder="e.g. Monthly Market Analysis Report">
            </div>
        </div>
        <div class="col-4 text-end">
            <div class="meta-group">
                <div class="label">Date of Session</div>
                <input type="date" id="mDate" class="value-text text-end">
            </div>
        </div>
        <div class="col-12">
            <div class="meta-group">
                <div class="label">Attendees in Attendance</div>
                <textarea rows="1" class="value-text" placeholder="Start typing names..." oninput="this.style.height='auto';this.style.height=this.scrollHeight+'px'"></textarea>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <h5 class="fw-bold" style="letter-spacing: -0.5px;">Summary of Deliberations</h5>
        <table class="table" id="discussionTable">
            <thead>
                <tr>
                    <th style="width: 40px">#</th>
                    <th>Substantive Points & Decisions</th>
                    <th style="width: 40px" class="no-print"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="text-muted">01</td>
                    <td><textarea rows="1" placeholder="Describe the discussion item..." oninput="this.style.height='auto';this.style.height=this.scrollHeight+'px'"></textarea></td>
                    <td class="no-print"><button class="btn btn-sm text-danger" onclick="this.closest('tr').remove()">×</button></td>
                </tr>
            </tbody>
        </table>
        <button class="btn btn-add no-print" onclick="addRow('discussionTable')">+ Add Discussion Point</button>
    </div>

    <div class="mt-5">
        <h5 class="fw-bold" style="letter-spacing: -0.5px;">Actionable Requirements</h5>
        <table class="table" id="actionTable">
            <thead>
                <tr>
                    <th>Assigned Task</th>
                    <th style="width: 180px">Action Owner</th>
                    <th style="width: 140px">Due Date</th>
                    <th style="width: 40px" class="no-print"></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" placeholder="Next step..."></td>
                    <td><input type="text" placeholder="Name"></td>
                    <td><input type="date"></td>
                    <td class="no-print"><button class="btn btn-sm text-danger" onclick="this.closest('tr').remove()">×</button></td>
                </tr>
            </tbody>
        </table>
        <button class="btn btn-add no-print" onclick="addActionRow()">+ Add Action Task</button>
    </div>

    <div class="footer-sign">
        <div class="row">
            <div class="col-6">
                <div class="label">Prepared & Recorded By</div>
                <input type="text" class="sig-line" placeholder="Full Name">
                <div class="label" style="font-size: 0.6rem; color: #cbd5e1;">Designation / Title</div>
            </div>
            <div class="col-6 text-end">
                <div class="label">Submission Date</div>
                <input type="date" id="subDate" class="value-text text-end">
            </div>
        </div>
    </div>
</div>

<script>
    // Initialize Dates
    const now = new Date().toISOString().split('T')[0];
    document.getElementById('mDate').value = now;
    document.getElementById('subDate').value = now;

    function addRow(id) {
        const table = document.getElementById(id).getElementsByTagName('tbody')[0];
        const row = table.insertRow();
        const num = String(table.rows.length).padStart(2, '0');
        row.innerHTML = `<td class="text-muted">${num}</td>
                         <td><textarea rows="1" oninput="this.style.height='auto';this.style.height=this.scrollHeight+'px'"></textarea></td>
                         <td class="no-print"><button class="btn btn-sm text-danger" onclick="this.closest('tr').remove()">×</button></td>`;
    }

    function addActionRow() {
        const table = document.getElementById('actionTable').getElementsByTagName('tbody')[0];
        const row = table.insertRow();
        row.innerHTML = `<td><input type="text"></td>
                         <td><input type="text"></td>
                         <td><input type="date"></td>
                         <td class="no-print"><button class="btn btn-sm text-danger" onclick="this.closest('tr').remove()">×</button></td>`;
    }

    function exportWord() {
        const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'></head><body>";
        const footer = "</body></html>";
        const html = header + document.getElementById('documentArea').innerHTML + footer;
        const blob = new Blob(['\ufeff', html], { type: 'application/msword' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'Energy_Market_Minutes.doc';
        link.click();
    }

    function shareWhatsApp() {
        const title = document.querySelector('input[placeholder="e.g. Monthly Market Analysis Report"]').value || "Meeting";
        const text = `*Energy Market Minutes: ${title}*\nDate: ${document.getElementById('mDate').value}\nStatus: Completed and Ready.`;
        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
    }
</script>

</body>
</html>
